<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="scrap">

<!-- <resultMap id="scrap" type="first.com.model.ScrapDTO">
	<result property="scrap_id" column="scrap_id" />
	<result property="member_id" column="member_id" />
	<result property="board_id" column="board_id" />
	<result property="bgroup_id" column="bgroup_id" />
</resultMap> -->

	<resultMap id="scrapBoard" type="first.com.model.ScrapDTO">
		<collection property="board" column="member_id" javaType="java.util.ArrayList"
		ofType="first.com.model.BoardDTO" select="list" />
	</resultMap>


    <!-- scrap테이블의 member_id칼럼에 존재하는 값과 비교하는 값은 둘 다 세션에서 전달받음 -->
	<select id="list" resultType="scrapBoard"><!-- 컬렉션에서 설정해준 column의 값이 아래 #{}의 값으로 설정된다 -->
	SELECT b.* FROM (SELECT board_id FROM scrap WHERE member_id = #{member_id}) a 
	INNER JOIN board b ON a.board_id = b.board_id ORDER BY b.board_date DESC;
	</select>
	
	<insert id="insert" parameterType="first.com.model.ScrapDTO">
	INSERT INTO scrap VALUES (#{scrap_id}, #{member_id}, #{board_id}, #{bgroup_id})
	</insert>
	
	<delete id="delete" parameterType="first.com.model.ScrapDTO">
	DELETE FROM scrap WHERE scrap_id = #{scrap_id}
	</delete>
</mapper>